
 >>>>>>>> Dev new stat2892

Namespace(b=4096, ct=False, e=5, et=None, f=16, fra=False, m='mlp_fe', mess='comparison opt', mt=3, ne=True, nfe=False, nm=False, ns=False, of=False, olv=False, opt='adagrad', rml=False, s=False, tdo=False, v=2, va=True, va_seed=62)
['appCategory', 'positionID', 'positionType', 'creativeID', 'appID', 'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType', 'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator', 'gender'] 16


Loaded datasets


Seed: 62 Batch size:  4096
--- Train cols:  Index(['appCategory', 'positionID', 'positionType', 'creativeID', 'appID',
       'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType',
       'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator',
       'gender', 'label'],
      dtype='object')
--- Max feature: 7646 222 210
--- Max column features: [ 504 7646    6 6583  473 3617   92  721    3    5 3402   81 3402    7    4
    3]
--- Max column ua features: [222   2   5  22 113  43 136  31 191  63  29  90   5  46  21  44  98  36
  62 138  26  32  18  27  37  21  52   1]
--- Max column ui features: [210   2   6  25 183  36 113  80  64  44  84  81  11 124  31  50 132  39
 150 202  69  89  18  62  31  40  98   1]
--- Selected most important features: 16
Using fine-grained embedding layers
[32, 30, 28, 26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2]

 Tue Jun  6 22:26:02 2017
Train on 3374575 samples, validate on 374953 samples
Epoch 1/5
 40960/338489 [==>...........................] - ETA: 41s 81920/338489 [======>.......................] - ETA: 22s122880/338489 [=========>....................] - ETA: 15s163840/338489 [=============>................] - ETA: 10s204800/338489 [=================>............] - ETA: 7s 245760/338489 [====================>.........] - ETA: 4s286720/338489 [========================>.....] - ETA: 2s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 16s    

Tr avg: 0.0248,   avg: 0.0221, std: 0.0297, written to: ../cb_2233_0606_tl_result_0.0221_0.0297_mlp_fe.csv

Epoch 00000: val_loss improved from inf to 0.10229, saving model to ../trained_models/cp_00-0.1023.h5
444s - loss: 0.1042 - binary_crossentropy: 0.1042 - val_loss: 0.1023 - val_binary_crossentropy: 0.1023
Epoch 2/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 6s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0236, std: 0.0316, written to: ../cb_2240_0606_tl_result_0.0236_0.0316_mlp_fe.csv

Epoch 00001: val_loss improved from 0.10229 to 0.10202, saving model to ../trained_models/cp_01-0.1020.h5
426s - loss: 0.1004 - binary_crossentropy: 0.1004 - val_loss: 0.1020 - val_binary_crossentropy: 0.1020
Epoch 3/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 6s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0241, std: 0.0334, written to: ../cb_2247_0606_tl_result_0.0241_0.0334_mlp_fe.csv

Epoch 00002: val_loss did not improve
433s - loss: 0.0998 - binary_crossentropy: 0.0998 - val_loss: 0.1023 - val_binary_crossentropy: 0.1023
Epoch 4/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 6s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0262, std: 0.0360, written to: ../cb_2255_0606_tl_result_0.0262_0.0360_mlp_fe.csv

Epoch 00003: val_loss did not improve
434s - loss: 0.0993 - binary_crossentropy: 0.0993 - val_loss: 0.1024 - val_binary_crossentropy: 0.1024
Epoch 5/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 9s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 6s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0224, std: 0.0342, written to: ../cb_2302_0606_tl_result_0.0224_0.0342_mlp_fe.csv

Epoch 00004: val_loss did not improve
434s - loss: 0.0988 - binary_crossentropy: 0.0988 - val_loss: 0.1033 - val_binary_crossentropy: 0.1033
Saved model:  ../trained_models/0606_230219_dnn.h5 Saved main: backup_mains/0606_230219_main_DNN.py
Runtime: 0:36:17

Prediction

Train average:  0.0248369053881
Preds average:  0.0223757
Preds std dev.:  0.0342452

Written to:  ../2302_0606_tl_result_0.0224_0.0342_mlp_fe.csv

 >>>>>>>> Dev new stat2892

Namespace(b=4096, ct=True, e=5, et=None, f=16, fra=False, m='mlp_fe', mess='continue train opt', mt=3, ne=True, nfe=False, nm=False, ns=False, of=False, olv=False, opt='adagrad', rml=False, s=False, tdo=False, v=2, va=True, va_seed=62)
['appCategory', 'positionID', 'positionType', 'creativeID', 'appID', 'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType', 'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator', 'gender'] 16


Loaded datasets


Seed: 62 Batch size:  4096
--- Train cols:  Index(['appCategory', 'positionID', 'positionType', 'creativeID', 'appID',
       'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType',
       'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator',
       'gender', 'label'],
      dtype='object')
--- Max feature: 7646 222 210
--- Max column features: [ 504 7646    6 6583  473 3617   92  721    3    5 3402   81 3402    7    4
    3]
--- Max column ua features: [222   2   5  22 113  43 136  31 191  63  29  90   5  46  21  44  98  36
  62 138  26  32  18  27  37  21  52   1]
--- Max column ui features: [210   2   6  25 183  36 113  80  64  44  84  81  11 124  31  50 132  39
 150 202  69  89  18  62  31  40  98   1]
--- Selected most important features: 16

Loaded model: ../trained_models/last_dnn.h5

 Tue Jun  6 23:03:35 2017
Train on 3374575 samples, validate on 374953 samples
Epoch 1/5
 40960/338489 [==>...........................] - ETA: 20s 81920/338489 [======>.......................] - ETA: 13s122880/338489 [=========>....................] - ETA: 10s163840/338489 [=============>................] - ETA: 7s 204800/338489 [=================>............] - ETA: 5s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 2s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 13s    

Tr avg: 0.0248,   avg: 0.0225, std: 0.0323, written to: ../cb_2310_0606_tl_result_0.0225_0.0323_mlp_fe.csv

Epoch 00000: val_loss improved from inf to 0.10240, saving model to ../trained_models/cp_00-0.1024.h5
436s - loss: 0.1012 - binary_crossentropy: 0.1012 - val_loss: 0.1024 - val_binary_crossentropy: 0.1024
Epoch 2/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 9s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 6s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0236, std: 0.0364, written to: ../cb_2318_0606_tl_result_0.0236_0.0364_mlp_fe.csv

Epoch 00001: val_loss did not improve
429s - loss: 0.0990 - binary_crossentropy: 0.0990 - val_loss: 0.1028 - val_binary_crossentropy: 0.1028
Epoch 3/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 5s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0254, std: 0.0397, written to: ../cb_2325_0606_tl_result_0.0254_0.0397_mlp_fe.csv

Epoch 00002: val_loss did not improve
428s - loss: 0.0982 - binary_crossentropy: 0.0982 - val_loss: 0.1031 - val_binary_crossentropy: 0.1031
Epoch 4/5
 40960/338489 [==>...........................] - ETA: 19s 81920/338489 [======>.......................] - ETA: 13s122880/338489 [=========>....................] - ETA: 10s163840/338489 [=============>................] - ETA: 7s 204800/338489 [=================>............] - ETA: 5s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 2s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 12s    

Tr avg: 0.0248,   avg: 0.0281, std: 0.0425, written to: ../cb_2332_0606_tl_result_0.0281_0.0425_mlp_fe.csv

Epoch 00003: val_loss did not improve
429s - loss: 0.0975 - binary_crossentropy: 0.0975 - val_loss: 0.1039 - val_binary_crossentropy: 0.1039
Epoch 5/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 5s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0269, std: 0.0463, written to: ../cb_2339_0606_tl_result_0.0269_0.0463_mlp_fe.csv

Epoch 00004: val_loss did not improve
426s - loss: 0.0965 - binary_crossentropy: 0.0965 - val_loss: 0.1046 - val_binary_crossentropy: 0.1046
Saved model:  ../trained_models/0606_233927_dnn.h5 Saved main: backup_mains/0606_233927_main_DNN.py
Runtime: 0:35:56

Prediction

Train average:  0.0248369053881
Preds average:  0.0268926
Preds std dev.:  0.0463143

Written to:  ../2339_0606_tl_result_0.0269_0.0463_mlp_fe.csv

 >>>>>>>> Dev new stat2892

Namespace(b=4096, ct=False, e=5, et=None, f=16, fra=False, m='mlp_fe', mess='comparison without va', mt=3, ne=True, nfe=False, nm=False, ns=False, of=False, olv=False, opt='adagrad', rml=False, s=False, tdo=False, v=2, va=False, va_seed=62)
['appCategory', 'positionID', 'positionType', 'creativeID', 'appID', 'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType', 'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator', 'gender'] 16


Loaded datasets


Seed: 62 Batch size:  4096
Not using validation
--- Train cols:  Index(['appCategory', 'positionID', 'positionType', 'creativeID', 'appID',
       'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType',
       'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator',
       'gender', 'label'],
      dtype='object')
--- Max feature: 7646 222 210
--- Max column features: [ 504 7646    6 6583  473 3617   92  721    3    5 3402   81 3402    7    4
    3]
--- Max column ua features: [222   2   5  22 113  43 136  31 191  63  29  90   5  46  21  44  98  36
  62 138  26  32  18  27  37  21  52   1]
--- Max column ui features: [210   2   6  25 183  36 113  80  64  44  84  81  11 124  31  50 132  39
 150 202  69  89  18  62  31  40  98   1]
--- Selected most important features: 16
Using fine-grained embedding layers
[32, 30, 28, 26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2]

 Tue Jun  6 23:40:36 2017
Epoch 1/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 5s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0249,   avg: 0.0222, std: 0.0300, written to: ../cb_2348_0606_tl_result_0.0222_0.0300_mlp_fe.csv


 >>>>>>>> Dev new stat2892

Namespace(b=4096, ct=False, e=5, et=None, f=16, fra=False, m='mlp_fe', mess='comparison opt', mt=3, ne=True, nfe=False, nm=False, ns=False, of=False, olv=False, opt='adam', rml=False, s=False, tdo=False, v=2, va=True, va_seed=62)
['appCategory', 'positionID', 'positionType', 'creativeID', 'appID', 'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType', 'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator', 'gender'] 16


Loaded datasets


Seed: 62 Batch size:  4096
--- Train cols:  Index(['appCategory', 'positionID', 'positionType', 'creativeID', 'appID',
       'adID', 'advertiserID', 'camgaignID', 'sitesetID', 'connectionType',
       'residence', 'age', 'hometown', 'haveBaby', 'telecomsOperator',
       'gender', 'label'],
      dtype='object')
--- Max feature: 7646 222 210
--- Max column features: [ 504 7646    6 6583  473 3617   92  721    3    5 3402   81 3402    7    4
    3]
--- Max column ua features: [222   2   5  22 113  43 136  31 191  63  29  90   5  46  21  44  98  36
  62 138  26  32  18  27  37  21  52   1]
--- Max column ui features: [210   2   6  25 183  36 113  80  64  44  84  81  11 124  31  50 132  39
 150 202  69  89  18  62  31  40  98   1]
--- Selected most important features: 16
Using fine-grained embedding layers
[32, 30, 28, 26, 24, 22, 20, 18, 16, 14, 12, 10, 8, 6, 4, 2]

 Tue Jun  6 23:48:57 2017
Train on 3374575 samples, validate on 374953 samples
Epoch 1/5
 40960/338489 [==>...........................] - ETA: 12s 81920/338489 [======>.......................] - ETA: 10s122880/338489 [=========>....................] - ETA: 8s 163840/338489 [=============>................] - ETA: 6s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 12s    

Tr avg: 0.0248,   avg: 0.0245, std: 0.0308, written to: ../cb_2356_0606_tl_result_0.0245_0.0308_mlp_fe.csv

Epoch 00000: val_loss improved from inf to 0.10231, saving model to ../trained_models/cp_00-0.1023.h5
435s - loss: 0.1050 - binary_crossentropy: 0.1050 - val_loss: 0.1023 - val_binary_crossentropy: 0.1023
Epoch 2/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 6s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0303, std: 0.0394, written to: ../cb_0003_0607_tl_result_0.0303_0.0394_mlp_fe.csv

Epoch 00001: val_loss did not improve
436s - loss: 0.1007 - binary_crossentropy: 0.1007 - val_loss: 0.1030 - val_binary_crossentropy: 0.1030
Epoch 3/5
 40960/338489 [==>...........................] - ETA: 10s 81920/338489 [======>.......................] - ETA: 8s 122880/338489 [=========>....................] - ETA: 7s163840/338489 [=============>................] - ETA: 5s204800/338489 [=================>............] - ETA: 4s245760/338489 [====================>.........] - ETA: 3s286720/338489 [========================>.....] - ETA: 1s327680/338489 [============================>.] - ETA: 0s338489/338489 [==============================] - 11s    

Tr avg: 0.0248,   avg: 0.0220, std: 0.0296, written to: ../cb_0010_0607_tl_result_0.0220_0.0296_mlp_fe.csv

Epoch 00002: val_loss did not improve
441s - loss: 0.1000 - binary_crossentropy: 0.1000 - val_loss: 0.1027 - val_binary_crossentropy: 0.1027
Epoch 4/5
